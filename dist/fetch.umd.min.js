function showLoadingMessage(){$("#loadingModal").modal({backdrop:"static",keyboard:!1})}function hideLoadingMessage(){$("#loadingModal").modal("hide")}function buildElement(e,t,n=null,o=null,i=null){if("string"!=typeof e){console.log("buildElement: Enter valid HTML for createElementText");return}let l=document.createElement("p");l.innerHTML=e;if(1!==l.childNodes[0].nodeType){console.error("buildElement: Enter valid HTML for createElementText");return}let a=$(e);return t&&"string"==typeof t&&a.append(document.createTextNode(t)),n&&(Array.isArray(n)?n.forEach(e=>{"string"==typeof e&&a.addClass(e)}):"string"==typeof n&&a.addClass(n)),o&&i&&"string"==typeof o&&"function"==typeof i&&a.on(o,i),a}let modalRepo=function(){let e=null,t=null;function n(n){var o;let i=(o=n).touches||o.originalEvent.touches;e=i[0].clientX,t=i[0].clientY}function o(){e=null,t=null}return{showModal:function i(l){let a=$("#infoModal .modal-dialog"),r=$("#infoModal .modal-title"),d=$(".modal-body");r.empty(),d.empty();let u=buildElement("<h2></h2>","#"+l.id+" "+l.name);r.append(u),d.append(buildElement("<p></p>",l.flavorText));let s=buildElement("<ul></ul>",null,"pokemon-stats"),p=buildElement("<li></li>","Height: ");s.append(p),p.append(buildElement("<p></p>",l.height.toString()));let c="Type:",f=buildElement("<li></li>",c);s.append(f),c="";for(let m=0;m<l.types.length;m++)c+=l.types[m].type.name,m!==l.types.length-1&&(c+=", ");f.append(buildElement("<p></p>",c));let h=buildElement("<li></li>",c="Abilities: ");s.append(h),c="";for(let g=0;g<l.abilities.length;g++)c+=l.abilities[g].ability.name,g!==l.types.length-1&&(c+=", ");h.append(buildElement("<p></p>",c)),d.append(s);let y=buildElement("<div></div>",null,"modal-image-container"),b=pokemonRepository.getAll(),L=b.indexOf(l);if(0!==L){let E=buildElement("<button></button>","<","modal-prev","click",()=>{pokemonRepository.showDetails(b[L-1])});y.append(E)}let k=buildElement("<img>",null,"modal-picture");if(k.attr("src",l.imageURL),k.attr("alt",l.name),y.append(k),L!==b.length-1){let R=buildElement("<button></button>",">","modal-next","click",()=>{pokemonRepository.showDetails(b[L+1])});y.append(R)}d.append(y),a.on("touchstart",n),a.on("touchend",o),a.on("touchcancel",o),a.on("touchmove",n=>(function n(o){if(!e||!t)return;let i=o.touches[0].clientX,l=o.touches[0].clientY,a=i-e;if(Math.abs(a)>Math.abs(l-t)){let r=pokemonRepository.getAll(),d=r.indexOf(pokemonRepository.getCurrent());a>0?d!==r.length-1&&pokemonRepository.showDetails(r[d+1]):0!==d&&pokemonRepository.showDetails(r[d-1])}e=null,t=null})(n))}}}(),pokemonRepository=function(){let e=[],t=null;function n(t){if("object"==typeof t){let n=Object.keys(t);if(n.includes("name")&&n.includes("detailsURL")){e.push(t);return}}}function o(){return e}function i(){return t}function l(t){return e.filter(e=>e.name.includes(t.toUpperCase()))}function a(e){let t=$("<li></li>");t.addClass("list-group-item");let n=buildElement("<button></button>",e.name,["btn","btn-primary","custom-button"],"click",()=>{s(e)});n.attr("data-toggle","modal"),n.attr("data-target","#infoModal"),n.attr("id",e.name);let o=$("<img>");o.attr("height","100"),o.attr("width","100"),n.append(o),t.append(n);$(".pokemonList").append(t)}function r(){$(".pokemonList").empty()}function d(){for(let t=0;t<e.length;t++){let n=$("#"+e[t].name+" img");n.attr("src",e[t].imageURL),t<10&&n.attr("loading","lazy"),n.attr("height","100"),n.attr("width","100"),n.attr("alt",e[t].name+" image")}}function u(e){return showLoadingMessage(),fetch(e.detailsURL).then(function(e){return e.json()}).then(function(t){e.imageURL=t.sprites.front_default,e.height=t.height,e.types=t.types,e.id=t.id,e.abilities=t.abilities,e.infoURL=t.species.url}).catch(function(e){console.error(e),hideLoadingMessage()})}function s(e){u(e).then(function(){var n;t=e;fetch((n=e).infoURL).then(function(e){return e.json()}).then(function(e){n.flavorText=e.flavor_text_entries[0].flavor_text,n.flavorText=n.flavorText.replaceAll("\n"," "),hideLoadingMessage()}).catch(function(e){console.error(e),hideLoadingMessage()}).then(function(){modalRepo.showModal(e)})})}return{add:n,getAll:o,getFiltered:l,addListItem:a,printFiltered:function t(n){""===n?(r(),e.forEach(function(e){a(e)})):(r(),l(n).forEach(function(e){a(e)})),d()},loadList:function e(){return showLoadingMessage(),fetch("https://pokeapi.co/api/v2/pokemon/?limit=150").then(function(e){return e.json()}).then(function(e){let t=e.results.map(function(e){var t;let o={name:e.name.toUpperCase(),detailsURL:e.url};return n(o),fetch((t=o).detailsURL).then(function(e){return e.json()}).then(function(e){t.imageURL=e.sprites.front_default}).catch(function(e){console.error(e)})});hideLoadingMessage(),Promise.allSettled(t).then(()=>{d()})}).catch(function(e){console.error(e),hideLoadingMessage()})},loadDetails:u,showDetails:s,getCurrent:i}}();pokemonRepository.loadList().then(function(){$(".pokemonList").empty(),pokemonRepository.getAll().forEach(function(e){pokemonRepository.addListItem(e)})});let searchBar=document.querySelector("#search");searchBar.addEventListener("input",function(e){pokemonRepository.printFiltered(e.target.value)});